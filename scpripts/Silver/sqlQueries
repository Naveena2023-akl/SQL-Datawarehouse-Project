---fix cmr_cust_info
INSERT INTO silver.crm_cust_info (
			cst_id, 
			cst_key, 
			cst_firstname, 
			cst_lastname, 
			cst_marital_status, 
			cst_gndr,
			cst_create_date
		)
select 
cst_id,cst_key,
 TRIM(cst_firstname)as cst_firstname,TRIM(cst_lastname) as cst_lastname ,
 case when UPPER(TRIM(cst_marital_status)) ='M' then 'Married'
     when UPPER(TRIM(cst_marital_status)) ='S'then 'Single' 
     else 'n/a' 
     END AS cst_marital_status,
     case when UPPER(TRIM(cst_gndr) )='F' then 'Female '
when upper(trim(cst_gndr))='M' then 'Male ' else 'n/a'
end as cst_gndr,cst_create_date from
(select *,row_number() over(partition by cst_id order by cst_id desc)
as rank_ctr_date from bronze.crm_cust_info) 
as t where rank_ctr_date= 1 and cst_id is not null ;
